---
// src/components/Header.astro
---

<header class="navbar">
  <nav class="navbar-inner">
    <a href="/" class="brand">
      <img src="/logo/USRad-Logo-final.png" alt="USRad Logo" class="logo" />
    </a>

    <ul class="nav-links">
      <li><a href="/about">About</a></li>
      <li><a href="/how-it-works" class="nav-link">How It Works</a></li>
      <li>
        <a href="/locations" class="location-link">
          <span class="icon-wrapper">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              class="location-icon"
              width="14"
              height="14"
              viewBox="0 0 24 24"
              stroke-width="2"
              stroke="currentColor"
              fill="none"
              stroke-linecap="round"
              stroke-linejoin="round"
            >
              <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
              <path d="M9 11a3 3 0 1 0 6 0a3 3 0 0 0 -6 0"></path>
              <path
                d="M17.657 16.657l-4.243 4.243a2 2 0 0 1 -2.827 0l-4.244 -4.243a8 8 0 1 1 11.314 0z"
              ></path>
            </svg>
          </span>
          Locations
        </a>
      </li>
      <li><a href="/pricing">Pricing</a></li>
      <li><a href="/contact">Contact</a></li>
    </ul>

    <div class="utility-container">
      <!-- Fixed partner button with correct class and title attributes -->
      <a
        href="/partner"
        class="partner-button"
        title="For Employers & Self-Insured Plans"
      >
        <span class="icon-wrapper">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="partner-icon"
            width="14"
            height="14"
            viewBox="0 0 24 24"
            stroke-width="2"
            stroke="currentColor"
            fill="none"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
            <path d="M9 12l-4 -4l4 -4"></path>
            <path d="M15 12l4 -4l-4 -4"></path>
            <path d="M7 16h10a2 2 0 1 0 0 -4h-10a2 2 0 1 0 0 4z"></path>
          </svg>
        </span>
        Partner
      </a>

      <ul class="utility-nav">
        <li>
          <a href="/login" class="login-link">
            <span class="icon-wrapper">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="login-icon"
                width="14"
                height="14"
                viewBox="0 0 24 24"
                stroke-width="2"
                stroke="currentColor"
                fill="none"
                stroke-linecap="round"
                stroke-linejoin="round"
              >
                <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                <path d="M8 7a4 4 0 1 0 8 0a4 4 0 0 0 -8 0"></path>
                <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2"></path>
              </svg>
            </span>
            Login
          </a>
        </li>
      </ul>
    </div>

    <button class="mobile-menu-toggle">
      <span class="toggle-bar"></span>
      <span class="toggle-bar"></span>
      <span class="toggle-bar"></span>
    </button>
  </nav>

  <div class="mobile-menu">
    <!-- Simplified mobile menu for improved layout consistency -->
    <ul class="mobile-nav-links">
      <li><a href="/about">About</a></li>
      <li><a href="/locations">Locations</a></li>
      <li><a href="/how-it-works">How It Works</a></li>
      <li><a href="/pricing">Pricing</a></li>
      <li><a href="/contact">Contact</a></li>
      <li><a href="/employer" class="highlight-item">Employer</a></li>
      <li><a href="/login">Login</a></li>
    </ul>
  </div>
</header>

<style>
  /* === Keyframes === */
  @keyframes shimmer {
    0% {
      background-position: -200% 0;
    }
    100% {
      background-position: 200% 0;
    }
  }

  :root {
    --font-manrope: "Manrope", -apple-system, BlinkMacSystemFont, "Segoe UI",
      Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue",
      sans-serif;
  }

  /* === Navbar Core === */
  .navbar {
    position: fixed;
    top: 2rem; /* Aligned with utility header height */
    left: 0;
    width: 100%;
    z-index: 50;
    padding-block: 0.75rem; /* Reduced padding */
    padding-inline: 2rem;
    background-color: #f5e7c5;
    backdrop-filter: blur(16px);
    -webkit-backdrop-filter: blur(16px);
    transition:
      background 0.3s ease,
      box-shadow 0.3s ease,
      padding 0.3s ease,
      backdrop-filter 0.3s ease;
    height: 4.5rem; /* Set explicit height */
  }

  @media (min-width: 768px) {
    .navbar {
      background: linear-gradient(to right, #f5e7c5 0%, #ffffff 100%);
    }
  }

  .navbar::after {
    content: "";
    position: absolute;
    bottom: 0;
    left: 0;
    height: 3px;
    width: 100%;
    background: linear-gradient(
      90deg,
      #cc9933,
      #e6c378,
      #cc9933,
      #e6c378,
      #cc9933
    );
    background-size: 200% auto;
    opacity: 0.15;
    transition: all 0.3s ease;
  }

  .navbar-inner {
    max-width: 1280px;
    margin: 0 auto;
    width: 100%;
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 1.5rem; /* Reduced from 2rem to give more horizontal space */
  }

  .brand .logo {
    height: 60px; /* Reduced from 65px to save vertical space */
    max-height: 60px;
    object-fit: contain;
  }

  /* === Desktop Navigation === */
  .nav-links,
  .utility-nav {
    display: flex;
    gap: 1.25rem; /* Reduced from 2rem to save space */
    list-style: none;
    margin: 0;
    padding: 0;
  }

  .nav-links a,
  .utility-nav a {
    font-family: var(--font-manrope);
    text-decoration: none;
    font-weight: 500;
    color: #0e1b2a;
    font-size: 1rem; /* Reduced from 1.125rem */
    padding: 0.5rem 0.5rem; /* Reduced horizontal padding */
    position: relative;
    display: inline-block;
    transition:
      color 0.3s ease,
      transform 0.3s ease;
  }

  /* === Partner Button & Utility Container === */
  .utility-container {
    display: flex;
    align-items: center;
    gap: 0.75rem;
  }

  .partner-button {
    font-family: var(--font-manrope);
    display: flex;
    align-items: center;
    background-color: rgba(204, 153, 51, 0.08);
    border: 1px solid #cc9933;
    color: #003087;
    font-weight: 600;
    padding: 0.4rem 0.75rem; /* Reduced padding */
    border-radius: 6px;
    transition: all 0.2s ease;
    font-size: 0.875rem;
    text-decoration: none;
    box-shadow: 0 1px 2px rgba(204, 153, 51, 0.1);
    white-space: nowrap; /* Prevent wrapping */
  }

  .partner-button:hover {
    background-color: rgba(204, 153, 51, 0.15);
    transform: translateY(-2px);
    box-shadow: 0 3px 6px rgba(204, 153, 51, 0.2);
  }

  .partner-button:active {
    transform: translateY(0);
    box-shadow: 0 1px 2px rgba(204, 153, 51, 0.1);
  }

  .icon-wrapper {
    display: inline-flex;
    align-items: center;
    margin-right: 4px;
  }

  .partner-icon {
    color: #cc9933;
  }

  .location-icon,
  .login-icon {
    color: inherit;
  }

  .location-link {
    display: flex;
    align-items: center;
  }

  .login-link {
    display: flex;
    align-items: center;
  }

  /* === Mobile Menu === */
  .mobile-menu-toggle {
    display: none;
    background: none;
    border: none;
    cursor: pointer;
    padding: 0.5rem;
  }

  .toggle-bar {
    display: block;
    width: 24px;
    height: 2px;
    margin: 5px 0;
    background-color: #0e1b2a;
    transition: transform 0.3s ease;
  }

  .mobile-menu {
    display: none;
    padding: 1.5rem 2rem;
    background: white;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    border-radius: 0.5rem;
    margin-top: 0.5rem;
  }

  .mobile-nav-links {
    list-style: none;
    padding: 0;
    margin: 0;
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
  }

  .mobile-nav-links a {
    font-family: var(--font-manrope);
    text-decoration: none;
    font-weight: 500;
    color: #0e1b2a;
    font-size: 1rem;
    display: block;
    padding: 0.5rem 0;
  }

  .highlight-item {
    font-weight: 600;
    color: #003087 !important;
  }

  /* === Mobile Overrides === */
  @media (max-width: 768px) {
    .navbar {
      top: 1.75rem; /* Match the mobile utility header height */
      padding-block: 0.4rem; /* Less vertical padding */
      padding-inline: 1rem; /* Less horizontal padding */
      height: 3.5rem; /* Smaller height on mobile but still visible */
    }

    .brand .logo {
      height: 45px; /* Smaller logo on mobile */
      max-height: 45px;
    }

    .navbar-inner {
      padding: 0.25rem;
    }

    .nav-links,
    .utility-container {
      display: none;
    }

    .mobile-menu-toggle {
      display: block;
    }

    .mobile-menu.active {
      display: block;
      position: absolute;
      right: 1rem;
      left: 1rem;
      top: 3.5rem; /* Position it below the header */
      z-index: 70; /* Higher z-index to appear above all headers */
    }

    .mobile-menu-toggle.active .toggle-bar:nth-child(1) {
      transform: translateY(7px) rotate(45deg);
    }

    .mobile-menu-toggle.active .toggle-bar:nth-child(2) {
      opacity: 0;
    }

    .mobile-menu-toggle.active .toggle-bar:nth-child(3) {
      transform: translateY(-7px) rotate(-45deg);
    }
  }

  /* === Scrolled State === */
  .navbar.navbar-scrolled {
    background-color: rgba(
      245,
      231,
      197,
      0.95
    ); /* Slightly transparent when scrolled */
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
    padding-block: 0.5rem; /* Smaller padding when scrolled */
  }

  @media (min-width: 768px) {
    .navbar.navbar-scrolled {
      background: linear-gradient(
        to right,
        rgba(245, 231, 197, 0.95) 0%,
        rgba(255, 255, 255, 0.95) 100%
      );
    }
  }

  /* When scrolled enough, keep utility header visible too */
  .navbar.navbar-scrolled {
    top: 1.75rem; /* Stay below utility header even when scrolled */
  }

  @media (max-width: 768px) {
    .navbar.navbar-scrolled .brand .logo {
      height: 40px; /* Even smaller logo when scrolled on mobile */
    }
  }
</style>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const navbar = document.querySelector(".navbar");
    const mobileMenuToggle = document.querySelector(".mobile-menu-toggle");
    const mobileMenu = document.querySelector(".mobile-menu");
    let shimmerTriggered = false;

    // Initial shimmer on load
    if (navbar) {
      navbar.classList.add("initial-shimmer");
      setTimeout(() => {
        navbar.classList.remove("initial-shimmer");
      }, 2500);
    }

    // Shimmer on scroll once and handle fixed positioning
    window.addEventListener("scroll", () => {
      if (window.scrollY > 80 && !shimmerTriggered) {
        // Changed from 10 to 80 for more scrolling
        shimmerTriggered = true;
        navbar.classList.add("navbar-scrolled", "once");

        // Remove shimmer class after animation finishes
        setTimeout(() => {
          navbar.classList.remove("once");
        }, 2500);
      } else if (window.scrollY <= 80) {
        navbar.classList.remove("navbar-scrolled");
        shimmerTriggered = false;
      }
    });

    // Mobile menu toggle
    if (mobileMenuToggle && mobileMenu && navbar) {
      mobileMenuToggle.addEventListener("click", function () {
        this.classList.toggle("active");
        mobileMenu.classList.toggle("active");

        if (mobileMenu.classList.contains("active")) {
          navbar.classList.add("navbar-menu-open");
        } else {
          navbar.classList.remove("navbar-menu-open");
        }
      });
    }
  });
</script>
