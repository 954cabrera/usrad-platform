---
import "../styles/global.css";
import AOSInit from "../components/AOSInit.astro";
import UtilityHeader from "../components/UtilityHeader.astro";
import Footer from "../components/Footer.astro";
---

<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title><slot name="title" /></title>

    <!-- Color scheme enforcement -->
    <meta name="color-scheme" content="light only" />
    <meta name="theme-color" content="#fcf9f0" />
    <meta name="apple-mobile-web-app-status-bar-style" content="default" />
    <meta name="msapplication-TileColor" content="#fcf9f0" />

    <!-- Font: Manrope -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Manrope:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />

    <!-- AOS Animation Init -->
    <AOSInit />
  </head>

  <body class="font-manrope text-[#003087] bg-[#fcf9f0] min-h-screen">
    <UtilityHeader />

    <header class="navbar">
      <nav class="navbar-inner">
        <a href="/" class="brand">
          <img src="/logo/USRad-Logo-final.png" alt="USRad Logo" class="logo" />
        </a>

        <ul class="nav-links">
          <li><a href="/about">About</a></li>
          <li><a href="/locations">Locations</a></li>
          <li><a href="/contact">Contact</a></li>
        </ul>

        <ul class="utility-nav">
          <li><a href="/login">Login</a></li>
        </ul>

        <button class="mobile-menu-toggle">
          <span class="toggle-bar"></span>
          <span class="toggle-bar"></span>
          <span class="toggle-bar"></span>
        </button>
      </nav>

      <div class="mobile-menu">
        <ul class="mobile-nav-links">
          <li><a href="/about">About</a></li>
          <li><a href="/locations">Locations</a></li>
          <li><a href="/contact">Contact</a></li>
          <li><a href="/login">Login</a></li>
          <li>
            <a href="/partner" class="mobile-partner-link"
              >For Imaging Centers</a
            >
          </li>
        </ul>
      </div>
    </header>

    <main class="main-content">
      <slot />
    </main>

    <Footer />

    <style>
      /* === Keyframes === */
      @keyframes shimmer {
        0% {
          background-position: -200% 0;
        }
        100% {
          background-position: 200% 0;
        }
      }

      /* === Navbar Core === */
      .navbar {
        position: fixed;
        top: 2rem;
        left: 0;
        width: 100%;
        z-index: 50;
        padding-block: 1.5rem;
        padding-inline: 2rem;
        background-color: #f5e7c5;
        backdrop-filter: blur(16px);
        -webkit-backdrop-filter: blur(16px);
        transition:
          background 0.3s ease,
          box-shadow 0.3s ease,
          padding 0.3s ease,
          backdrop-filter 0.3s ease;
      }

      @media (min-width: 768px) {
        .navbar {
          background: linear-gradient(to right, #f5e7c5 0%, #ffffff 100%);
        }
      }

      .navbar::after {
        content: "";
        position: absolute;
        bottom: 0;
        left: 0;
        height: 3px;
        width: 100%;
        background: linear-gradient(
          90deg,
          #cc9933,
          #e6c378,
          #cc9933,
          #e6c378,
          #cc9933
        );
        background-size: 200% auto;
        opacity: 0.15;
        transition: all 0.3s ease;
      }

      .navbar.initial-shimmer::after {
        opacity: 0.6;
        height: 4px;
        animation: shimmer 3s linear 1;
      }

      .navbar-scrolled.once::after {
        opacity: 0.6;
        height: 4px;
        animation: shimmer 3s linear 1;
      }

      .navbar-menu-open::after {
        opacity: 0.6;
        height: 4px;
        animation: shimmer 3s linear infinite;
      }

      .navbar-scrolled {
        background: #f5e7c5;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        padding-block: 1rem;
        transition:
          background 0.3s ease,
          box-shadow 0.3s ease,
          padding 0.3s ease,
          backdrop-filter 0.3s ease;
      }

      .navbar-inner {
        max-width: 1280px;
        margin: 0 auto;
        width: 100%;
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 2rem;
      }

      .brand .logo {
        height: 75px;
        max-height: 75px;
        object-fit: contain;
      }

      /* === Desktop Navigation === */
      .nav-links,
      .utility-nav {
        display: flex;
        gap: 1.5rem;
        list-style: none;
        margin: 0;
        padding: 0;
      }

      .nav-links a,
      .utility-nav a {
        text-decoration: none;
        font-weight: 500;
        color: #0e1b2a;
        font-size: 1.125rem;
        padding: 0.5rem 0.75rem;
        position: relative;
        display: inline-block;
        transition:
          color 0.3s ease,
          transform 0.3s ease;
      }

      .nav-links a::before,
      .utility-nav a::before {
        content: "";
        position: absolute;
        width: 0;
        height: 2px;
        bottom: 0;
        left: 0;
        background-color: #e6c378;
        visibility: hidden;
        transition: all 0.3s ease-in-out;
      }

      .nav-links a:hover::before,
      .utility-nav a:hover::before {
        visibility: visible;
        width: 100%;
      }

      .nav-links a:hover,
      .utility-nav a:hover {
        color: #e6c378;
        transform: translateY(-2px);
      }

      /* === Mobile Menu === */
      .mobile-menu-toggle {
        display: none;
        background: none;
        border: none;
        cursor: pointer;
        padding: 0.5rem;
      }

      .toggle-bar {
        display: block;
        width: 24px;
        height: 2px;
        margin: 5px 0;
        background-color: #0e1b2a;
        transition: transform 0.3s ease;
      }

      .mobile-menu {
        display: none;
        padding: 1.5rem 2rem;
        background: white;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      }

      .mobile-nav-links {
        list-style: none;
        padding: 0;
        margin: 0;
      }

      .mobile-nav-links li {
        margin-bottom: 1rem;
      }

      .mobile-nav-links a {
        text-decoration: none;
        font-weight: 500;
        color: #0e1b2a;
        font-size: 1.1rem;
        display: block;
        padding: 0.5rem 0;
        position: relative;
      }

      .mobile-nav-links a::before {
        content: "";
        position: absolute;
        width: 0;
        height: 2px;
        bottom: 0;
        left: 0;
        background-color: #e6c378;
        visibility: hidden;
        transition: all 0.3s ease-in-out;
      }

      .mobile-nav-links a:hover::before {
        visibility: visible;
        width: 100%;
      }

      .mobile-partner-link {
        color: #003087;
        font-weight: 600;
      }

      /* === Mobile Overrides === */
      @media (max-width: 768px) {
        .navbar {
          top: 0; /* Move to top of screen on mobile */
          padding-block: 0.5rem; /* Much less vertical padding */
          padding-inline: 1rem; /* Less horizontal padding */
        }

        .brand .logo {
          height: 50px; /* Smaller logo on mobile */
          max-height: 50px;
        }

        /* Adjust main content padding to match reduced header height */
        .main-content {
          padding-top: 80px; /* Reduced from 140px */
        }

        .navbar-inner {
          padding: 0.5rem;
        }

        .nav-links,
        .utility-nav {
          display: none;
        }

        .mobile-menu-toggle {
          display: block;
        }

        .mobile-menu.active {
          display: block;
        }

        .mobile-menu-toggle.active .toggle-bar:nth-child(1) {
          transform: translateY(7px) rotate(45deg);
        }

        .mobile-menu-toggle.active .toggle-bar:nth-child(2) {
          opacity: 0;
        }

        .mobile-menu-toggle.active .toggle-bar:nth-child(3) {
          transform: translateY(-7px) rotate(-45deg);
        }
      }

      /* === Main Content Padding === */
      .main-content {
        padding-top: 140px;
      }
    </style>

    <script is:inline>
      document.addEventListener("DOMContentLoaded", function () {
        const navbar = document.querySelector(".navbar");
        const mobileMenuToggle = document.querySelector(".mobile-menu-toggle");
        const mobileMenu = document.querySelector(".mobile-menu");
        let shimmerTriggered = false;

        // Initial shimmer on load
        if (navbar) {
          navbar.classList.add("initial-shimmer");
          setTimeout(() => {
            navbar.classList.remove("initial-shimmer");
          }, 2500);
        }

        // Shimmer on scroll once
        window.addEventListener("scroll", () => {
          if (window.scrollY > 10 && !shimmerTriggered) {
            shimmerTriggered = true;
            navbar.classList.add("navbar-scrolled", "once");

            // Remove shimmer class after animation finishes
            setTimeout(() => {
              navbar.classList.remove("once");
            }, 2500);
          } else if (window.scrollY <= 10) {
            navbar.classList.remove("navbar-scrolled");
            shimmerTriggered = false;
          }
        });

        // Mobile menu shimmer
        if (mobileMenuToggle && mobileMenu && navbar) {
          mobileMenuToggle.addEventListener("click", function () {
            this.classList.toggle("active");
            mobileMenu.classList.toggle("active");

            if (mobileMenu.classList.contains("active")) {
              navbar.classList.add("navbar-menu-open");
            } else {
              navbar.classList.remove("navbar-menu-open");
            }
          });
        }
      });
    </script>
  </body>
</html>
